fonc optionel(drapeau : bool, valeur : n32) -> n32
{
	retourne -transtype(drapeau : n32) & valeur;
}

# opérateur ternaire sans branche : si drapeau est vrai retourne v1, sinon v2
fonc ternaire(drapeau : bool, v1 : n32, v2 : n32) -> n32
{
	retourne (-transtype(drapeau : n32) & v1)
	         | ((transtype(drapeau : n32) - 1) & v2);
}

fonc échange(a : *r64, b : *r64) -> rien
{
	temp := mémoire(a);
	mémoire(a) = mémoire(b);
	mémoire(b) = temp;
}

# retourne les 4 valeurs minimales d'un tableau
fonc min4(p : []r64) -> rien
{
	q := p.longueur / 4;
	q2 := q + q;

	chac i dans q...(q2 - 1) {
		m0 := i - optionel(p[i - q] <= p[i], q);
		m1 := i + q - optionel(p[i + q2] < p[i + q], q);
		échange(@p[i - q], @p[p[m0] <= p[m1] ? m0 : m1]);
	}
}
