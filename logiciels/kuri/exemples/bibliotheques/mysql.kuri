#!inclus "mysql/mysql.h"

#!bib "mysqlclient"

fonc externe mysql_fetch_row() : ;

corout iter_résultat_requête(resultat)
{
    boucle {
        soit ligne = mysql_fetch_row(resultat);

        si ligne == nul {
            arrête;
        }

        retiens ligne;
    }
}

fonc iter_résultat_requête(resultat, ligne) : chaine
{
    soit longueurs = mysql_fetch_lengths(resultat);
    soit nombre_champs = mysql_num_fields(resultat);

    pour i dans 0 ... nombre_champs - 1 {
        dyn champ : chaine;
        champ.pointeur = ligne[i];
        champ.taille = longueurs[i];
        retiens champ;
    }
}

fonc test_mysql()
{
    pour ligne dans iter_résultat_requête(resultat) {
        pour champ dans iter_champ_ligne(resultat, ligne) {

        }
    }
}
